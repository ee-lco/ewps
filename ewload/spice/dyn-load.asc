Version 4
SHEET 1 1364 1064
WIRE 352 -656 224 -656
WIRE 480 -656 352 -656
WIRE 352 -624 352 -656
WIRE 480 -560 480 -656
WIRE 352 -528 352 -560
WIRE 832 -496 736 -496
WIRE 960 -496 912 -496
WIRE 1152 -496 1040 -496
WIRE 1152 -448 1152 -496
WIRE 352 -432 352 -464
WIRE 480 -368 480 -480
WIRE 736 -336 736 -496
WIRE 1024 -336 736 -336
WIRE 352 -320 352 -368
WIRE 416 -320 352 -320
WIRE -1024 -304 -1056 -304
WIRE -928 -304 -960 -304
WIRE -784 -304 -848 -304
WIRE 352 -272 352 -320
WIRE 1152 -272 1152 -368
WIRE 736 -256 736 -336
WIRE 1024 -240 1024 -336
WIRE -1056 -208 -1056 -304
WIRE -1056 -208 -1088 -208
WIRE -960 -208 -1056 -208
WIRE -784 -208 -784 -304
WIRE -784 -208 -880 -208
WIRE -768 -208 -784 -208
WIRE -624 -208 -768 -208
WIRE -480 -208 -544 -208
WIRE 96 -208 32 -208
WIRE 240 -208 160 -208
WIRE 480 -176 480 -272
WIRE 688 -176 480 -176
WIRE 352 -144 352 -192
WIRE 1024 -112 1024 -160
WIRE -576 -80 -576 -96
WIRE 480 -80 480 -176
WIRE 736 -80 736 -160
WIRE 832 -80 736 -80
WIRE -768 -64 -768 -208
WIRE -608 -64 -768 -64
WIRE 128 -64 128 -80
WIRE -480 -48 -480 -208
WIRE -480 -48 -544 -48
WIRE -384 -48 -384 -96
WIRE -384 -48 -480 -48
WIRE -368 -48 -384 -48
WIRE -256 -48 -256 -96
WIRE -256 -48 -288 -48
WIRE -160 -48 -256 -48
WIRE 32 -48 32 -208
WIRE 32 -48 -80 -48
WIRE 96 -48 32 -48
WIRE 736 -48 736 -80
WIRE -608 -32 -1056 -32
WIRE 240 -32 240 -208
WIRE 240 -32 160 -32
WIRE 416 -32 240 -32
WIRE 96 -16 -32 -16
WIRE -576 0 -576 -16
WIRE 128 16 128 0
WIRE -160 80 -224 80
WIRE -32 80 -32 -16
WIRE -32 80 -80 80
WIRE 480 96 480 16
WIRE 736 96 736 32
WIRE 1024 96 1024 -48
WIRE -1152 384 -1152 336
WIRE -1024 400 -1024 336
WIRE -1152 512 -1152 464
WIRE -1152 512 -1248 512
WIRE -1024 512 -1024 480
WIRE -1024 512 -1152 512
WIRE -1248 544 -1248 512
WIRE -1152 576 -1152 512
WIRE -1152 704 -1152 656
FLAG -1248 544 0
FLAG -1152 336 V+
FLAG -1152 704 V-
FLAG 736 96 0
FLAG 832 -80 Isense1
FLAG -224 80 Vset
FLAG -1024 336 Vset
FLAG 480 96 0
FLAG 224 -656 V+
FLAG 128 -80 V+
FLAG 128 16 V-
FLAG 1152 -272 0
FLAG 1024 96 0
FLAG 352 -144 0
FLAG -576 -96 V+
FLAG -576 0 V-
FLAG -1056 -32 Isense1
FLAG -1088 -208 0
FLAG -384 -96 A1
FLAG -256 -96 B1
SYMBOL voltage -1152 368 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V1
SYMATTR Value 15
SYMBOL voltage -1152 560 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V2
SYMATTR Value 15
SYMBOL voltage -1024 384 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V3
SYMATTR Value 0.5
SYMBOL nmos 688 -256 R0
SYMATTR InstName M1
SYMATTR Value IRFP250N
SYMBOL res 720 -64 R0
SYMATTR InstName Rsense1
SYMATTR Value {1/(setgain1*sensegain1)}
SYMBOL pnp 416 16 M180
SYMATTR InstName Q1
SYMATTR Value 2N2907
SYMBOL pnp 416 -272 M180
SYMATTR InstName Q2
SYMATTR Value 2N2907
SYMBOL Opamps\\TL072 -576 -112 R0
SYMATTR InstName U1
SYMBOL Opamps\\TL072 128 -96 R0
SYMATTR InstName U2
SYMBOL cap 160 -224 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value {Cea_c}
SYMBOL diode 336 -624 R0
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL diode 336 -528 R0
SYMATTR InstName D2
SYMATTR Value 1N4148
SYMBOL diode 336 -432 R0
SYMATTR InstName D3
SYMATTR Value 1N4148
SYMBOL res 464 -576 R0
SYMATTR InstName R14
SYMATTR Value 120
SYMBOL ind 928 -512 R90
WINDOW 0 5 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Lload1
SYMATTR Value 3.3µ
SYMBOL res 1056 -512 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rload1
SYMATTR Value 0.1
SYMBOL voltage 1152 -464 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName Vload1
SYMATTR Value 10
SYMBOL cap 1008 -112 R0
SYMATTR InstName C3
SYMATTR Value 2.2µ
SYMBOL res 336 -288 R0
SYMATTR InstName R6
SYMATTR Value 2.7k
SYMBOL res 1008 -256 R0
SYMATTR InstName R7
SYMATTR Value 2.2
SYMBOL res -64 -64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value {Rser1}
SYMBOL res -64 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value {Rser1}
SYMBOL cap -960 -320 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value {Ccsa_c}
SYMBOL res -832 -320 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value {Rcsa_c}
SYMBOL res -976 -224 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value {Rcsa1}
SYMBOL res -640 -224 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value {Rcsa1*(sensegain1 - 1)}
SYMBOL voltage -272 -48 R90
WINDOW 123 24 44 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value2 AC 1
SYMATTR InstName V5
SYMATTR Value 0
TEXT -480 256 Left 2 ;current sense amplifier
TEXT 32 256 Left 2 ;error amplifier
TEXT 480 256 Left 2 ;driver
TEXT 736 256 Left 2 ;series pass element
TEXT 368 -184 Left 2 ;~ 5mA
TEXT 496 -472 Left 2 ;~ 10mA
TEXT -416 608 Left 2 !.PARAM setgain1 1
TEXT -96 672 Left 2 !;.STEP PARAM sensegain1 LIST 10 20 50 100
TEXT -416 832 Left 2 !.PARAM Rcsa1 1k
TEXT -96 608 Left 2 ;Vset: 1V => setgain1 * 1A
TEXT -416 416 Left 2 ;.AC OCT 10 1 10MEG
TEXT -96 640 Left 2 !;.STEP PARAM Iset LIST 10u 100u 1m 10m 100m
TEXT -416 640 Left 2 !.PARAM Iset 5
TEXT -416 512 Left 2 !.MEAS AC ph_min MIN(Ph(V(isense1)/V(inj1))) TARG Mag(V(isense1)/V(inj1))=1 FALL=1
TEXT -416 736 Left 2 !.PARAM Ccsa_c 220p
TEXT -416 800 Left 2 !.PARAM Cea_c 470p
TEXT -416 768 Left 2 !.PARAM Rcsa_c 0.1
TEXT -416 672 Left 2 !.PARAM sensegain1 10
TEXT -96 736 Left 2 !;.STEP PARAM Ccsa_c LIST 0.1p 100p 150p 220p 330p 470p 680p 1n 1.5n 2.2n
TEXT -96 768 Left 2 !;.STEP PARAM Rcsa_c LIST 0.1 100 150 220 330 470 680 1k
TEXT -416 448 Left 2 !.AC OCT 10 100 1MEG
TEXT -416 864 Left 2 !.PARAM Rser1 10k
TEXT -96 800 Left 2 !;.STEP PARAM Cea_c LIST 0.1p 100p 150p 220p 330p 470p 680p 1n 1.5n 2.2n
TEXT -416 544 Left 2 !.OPTIONS meascplxfmt=polar
