Version 4
SHEET 1 1364 1064
WIRE 128 -624 0 -624
WIRE 256 -624 128 -624
WIRE 128 -592 128 -624
WIRE 256 -528 256 -624
WIRE 128 -496 128 -528
WIRE 608 -464 512 -464
WIRE 736 -464 688 -464
WIRE 928 -464 816 -464
WIRE 928 -416 928 -464
WIRE 128 -400 128 -432
WIRE 256 -336 256 -448
WIRE 512 -304 512 -464
WIRE 800 -304 512 -304
WIRE 128 -288 128 -336
WIRE 192 -288 128 -288
WIRE -1024 -272 -1056 -272
WIRE -928 -272 -960 -272
WIRE -784 -272 -848 -272
WIRE 128 -240 128 -288
WIRE 928 -240 928 -336
WIRE 512 -224 512 -304
WIRE 800 -208 800 -304
WIRE -1232 -176 -1360 -176
WIRE -1056 -176 -1056 -272
WIRE -1056 -176 -1088 -176
WIRE -960 -176 -1056 -176
WIRE -784 -176 -784 -272
WIRE -784 -176 -880 -176
WIRE -768 -176 -784 -176
WIRE -624 -176 -768 -176
WIRE -480 -176 -544 -176
WIRE -128 -176 -192 -176
WIRE 16 -176 -64 -176
WIRE -1232 -144 -1232 -176
WIRE 256 -144 256 -240
WIRE 464 -144 256 -144
WIRE 128 -112 128 -160
WIRE 800 -80 800 -128
WIRE -576 -48 -576 -64
WIRE 256 -48 256 -144
WIRE 512 -48 512 -128
WIRE 608 -48 512 -48
WIRE -768 -32 -768 -176
WIRE -608 -32 -768 -32
WIRE -96 -32 -96 -48
WIRE -480 -16 -480 -176
WIRE -480 -16 -544 -16
WIRE -384 -16 -480 -16
WIRE -192 -16 -192 -176
WIRE -192 -16 -304 -16
WIRE -128 -16 -192 -16
WIRE 512 -16 512 -48
WIRE -1232 0 -1232 -64
WIRE -1232 0 -1360 0
WIRE -608 0 -1232 0
WIRE 16 0 16 -176
WIRE 16 0 -64 0
WIRE 192 0 16 0
WIRE -128 16 -256 16
WIRE -576 32 -576 16
WIRE -96 48 -96 32
WIRE -384 112 -448 112
WIRE -256 112 -256 16
WIRE -256 112 -304 112
WIRE 256 128 256 48
WIRE 512 128 512 64
WIRE 800 128 800 -16
WIRE -1376 416 -1376 368
WIRE -1248 432 -1248 368
WIRE -1376 544 -1376 496
WIRE -1376 544 -1472 544
WIRE -1248 544 -1248 512
WIRE -1248 544 -1376 544
WIRE -1472 576 -1472 544
WIRE -1376 608 -1376 544
WIRE -1376 736 -1376 688
FLAG -576 -64 V+
FLAG -576 32 V-
FLAG 512 128 0
FLAG 608 -48 Isense1
FLAG -448 112 Vset
FLAG 256 128 0
FLAG 0 -624 V+
FLAG -1360 0 inj1
FLAG -96 -48 V+
FLAG -96 48 V-
FLAG -1360 -176 Isense1
FLAG 928 -240 0
FLAG 800 128 0
FLAG 128 -112 0
FLAG -1088 -176 0
FLAG -1472 576 0
FLAG -1376 368 V+
FLAG -1376 736 V-
FLAG -1248 368 Vset
SYMBOL nmos 464 -224 R0
SYMATTR InstName M1
SYMATTR Value IRFP250N
SYMBOL res 496 -32 R0
SYMATTR InstName Rsense1
SYMATTR Value {1/(setgain1*sensegain1)}
SYMBOL pnp 192 48 M180
SYMATTR InstName Q1
SYMATTR Value 2N2907
SYMBOL pnp 192 -240 M180
SYMATTR InstName Q2
SYMATTR Value 2N2907
SYMBOL voltage -1232 -160 R0
WINDOW 123 24 44 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value2 AC 1
SYMATTR InstName V4
SYMATTR Value 0
SYMBOL Opamps\\TL072 -96 -64 R0
SYMATTR InstName U2
SYMBOL cap -64 -192 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value {C2}
SYMBOL diode 112 -592 R0
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL diode 112 -496 R0
SYMATTR InstName D2
SYMATTR Value 1N4148
SYMBOL diode 112 -400 R0
SYMATTR InstName D3
SYMATTR Value 1N4148
SYMBOL res 240 -544 R0
SYMATTR InstName R14
SYMATTR Value 120
SYMBOL ind 704 -480 R90
WINDOW 0 5 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Lload1
SYMATTR Value 3.3µ
SYMBOL res 832 -480 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rload1
SYMATTR Value 0.1
SYMBOL voltage 928 -432 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName Vload1
SYMATTR Value 10
SYMBOL cap 784 -80 R0
SYMATTR InstName C3
SYMATTR Value 2.2µ
SYMBOL cap -960 -288 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value {C1}
SYMBOL res -832 -288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value {R3}
SYMBOL res 112 -256 R0
SYMATTR InstName R6
SYMATTR Value 2.7k
SYMBOL res 784 -224 R0
SYMATTR InstName R7
SYMATTR Value 2.2
SYMBOL res -976 -192 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value {Rcsa1}
SYMBOL res -640 -192 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value {Rcsa1*(sensegain1 - 1)}
SYMBOL res -288 -32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value {Rser1}
SYMBOL res -288 96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value {Rser1}
SYMBOL Opamps\\OP07 -576 -80 R0
SYMATTR InstName U1
SYMBOL voltage -1376 400 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V1
SYMATTR Value 15
SYMBOL voltage -1376 592 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V2
SYMATTR Value 15
SYMBOL voltage -1248 416 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V3
SYMATTR Value 0.5
TEXT 144 -152 Left 2 ;~ 5mA
TEXT 272 -440 Left 2 ;~ 10mA
TEXT -704 288 Left 2 ;current sense amplifier
TEXT -192 288 Left 2 ;error amplifier
TEXT 256 288 Left 2 ;driver
TEXT 512 288 Left 2 ;series pass element
TEXT -640 640 Left 2 !.PARAM setgain1 1
TEXT -320 704 Left 2 !;.STEP PARAM sensegain1 LIST 10 20 50 100
TEXT -320 640 Left 2 ;Vset: 1V => setgain1 * 1A
TEXT -640 448 Left 2 ;.AC OCT 10 1 10MEG
TEXT -320 672 Left 2 !;.STEP PARAM Iset LIST 10u 100u 1m 10m 100m
TEXT -640 672 Left 2 !.PARAM Iset 5
TEXT -640 544 Left 2 !.MEAS AC ph_min MIN(Ph(V(isense1)/V(inj1))) TARG Mag(V(isense1)/V(inj1))=1 FALL=1
TEXT -640 768 Left 2 !.PARAM C1 1n
TEXT -640 800 Left 2 !.PARAM C2 1n
TEXT -640 832 Left 2 !.PARAM R3 100
TEXT -640 704 Left 2 !.PARAM sensegain1 10
TEXT -320 768 Left 2 !;.STEP PARAM C1 LIST 0.1p 100p 150p 220p 330p 470p 680p 1n 1.5n 2.2n
TEXT -320 800 Left 2 !;.STEP PARAM C2 LIST 0.1p 100p 150p 220p 330p 470p 680p 1n 1.5n 2.2n
TEXT -640 480 Left 2 !.AC OCT 10 100 1MEG
TEXT -640 864 Left 2 !.PARAM Rcsa1 1k
TEXT -640 896 Left 2 !.PARAM Rser1 1k
